(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const h of o.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&s(h)}).observe(document,{childList:!0,subtree:!0});function e(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerPolicy&&(o.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?o.credentials="include":n.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(n){if(n.ep)return;n.ep=!0;const o=e(n);fetch(n.href,o)}})();const P=10,K=30,U=5,gt=10;let l=gt;const B=24;let E=0,ht=0;const G=480,q=480,R=300,N=140,Q=180,mt=8,pt=4,yt=.08,et=.35;let tt=0;const bt=15,Ct=12,M=10,F=3,wt=8,L=1;let x=[],st=0,V=0,nt=0,it=0,ot=0,Y=0,X=0,W=0,$=0,Z=0,z=0;function at(){E=l*B,ht=l*l-3,tt=l*l}function St(T){const t=[];let e=wt;for(let s=0;s<T;s++)t.push(e),e=Math.max(2,Math.round(2*e/3));return t}function vt(){x=St(L),st=x.length>0?M*x[0]:0,V=0;for(let t=1;t<x.length;t++)V+=x[t-1]*x[t];nt=x.reduce((t,e)=>t+e,0),it=(x.length>0?x[x.length-1]:M)*F,ot=F,Y=0,X=Y+st,W=X+V,$=W+nt,Z=$+it,z=Z+ot}at();vt();function Tt(T){const t=Math.min(K,Math.max(P,T)),e=P+Math.round((t-P)/U)*U,s=Math.min(K,Math.max(P,e));return s!==l&&(l=s,at()),l}const rt=8,J=["Block Ahead","Block Left","Block Right","Tail Ahead","Tail Left","Tail Right","Food Ahead","Food Side","Dir X","Dir Y"],j=["Straight","Turn left","Turn right"],D=[{x:0,y:-1},{x:1,y:0},{x:0,y:1},{x:-1,y:0}];class Mt{net;netCtx;board;ctx;chart;chartCtx;stats;showNetwork=!0;netMouse=null;constructor(t){this.net=t.netCanvas,this.board=t.boardCanvas,this.chart=t.chartCanvas,this.stats=t.statsElement,this.netCtx=this.net.getContext("2d"),this.ctx=this.board.getContext("2d"),this.chartCtx=this.chart.getContext("2d"),this.net.width=G,this.net.height=q,this.board.width=E,this.board.height=E,this.chart.width=R,this.chart.height=N,this.net.addEventListener("mousemove",e=>{const s=this.net.getBoundingClientRect(),n=this.net.width/s.width,o=this.net.height/s.height;this.netMouse={x:(e.clientX-s.left)*n,y:(e.clientY-s.top)*o}}),this.net.addEventListener("mouseleave",()=>{this.netMouse=null,this.net.style.cursor="default"})}setShowNetwork(t){this.showNetwork=t,this.net.style.display=t?"block":"none",t||(this.netMouse=null,this.net.style.cursor="default")}render(t){this.syncBoardSize(),this.showNetwork&&this.drawNetwork(t),this.drawBoard(t),this.drawHistory(t.fitnessHistory),this.updateStats(t)}syncBoardSize(){(this.board.width!==E||this.board.height!==E)&&(this.board.width=E,this.board.height=E)}segmentDistanceSquared(t,e,s,n,o,h){const p=o-s,b=h-n,f=t-s,C=e-n,y=p*p+b*b;if(y<=1e-6){const i=t-s,r=e-n;return i*i+r*r}let g=(f*p+C*b)/y;g=Math.max(0,Math.min(1,g));const c=s+g*p,w=n+g*b,A=t-c,u=e-w;return A*A+u*u}drawNetwork(t){const{genome:e,activations:s}=t.network;if(this.netCtx.fillStyle="#000",this.netCtx.fillRect(0,0,G,q),!e||!s)return;let n=.001;for(let i=0;i<F;i++)n=Math.max(n,Math.abs(s.output[i]));const o=x.length,h=24,p=q-24,b=84,f=G-84,C=[],y=[],g=[],c=[];for(let i=0;i<M;i++)C.push(h+i*(p-h)/Math.max(1,M-1));for(let i=0;i<o;i++)y.push(b+(i+1)*(f-b)/(o+1));for(let i=0;i<o;i++){const r=x[i],a=[];for(let m=0;m<r;m++)a.push(h+m*(p-h)/Math.max(1,r-1));g.push(a)}for(let i=0;i<F;i++)c.push(h+i*(p-h)/Math.max(1,F-1));const w=[];if(o>0){const i=y[0],r=g[0],a=x[0];for(let d=0;d<a;d++){const H=Y+d*M;for(let v=0;v<M;v++)w.push({x1:b,y1:C[v],x2:i,y2:r[d],weight:e[H+v],label:`${J[v]} -> H1:${d+1}`})}let m=X;for(let d=1;d<o;d++){const H=x[d-1],v=x[d],ct=y[d-1],ft=y[d],ut=g[d-1],dt=g[d];for(let k=0;k<v;k++){const xt=m+k*H;for(let _=0;_<H;_++)w.push({x1:ct,y1:ut[_],x2:ft,y2:dt[k],weight:e[xt+_],label:`H${d}:${_+1} -> H${d+1}:${k+1}`})}m+=H*v}const S=y[o-1],I=g[o-1],O=x[o-1];for(let d=0;d<F;d++){const H=$+d*O;for(let v=0;v<O;v++)w.push({x1:S,y1:I[v],x2:f,y2:c[d],weight:e[H+v],label:`H${o}:${v+1} -> ${j[d]}`})}}else for(let i=0;i<F;i++){const r=$+i*M;for(let a=0;a<M;a++)w.push({x1:b,y1:C[a],x2:f,y2:c[i],weight:e[r+a],label:`${J[a]} -> ${j[i]}`})}let A=.001;for(const i of w)A=Math.max(A,Math.abs(i.weight));let u=null;if(this.netMouse){let i=rt*rt;for(const r of w){const a=this.segmentDistanceSquared(this.netMouse.x,this.netMouse.y,r.x1,r.y1,r.x2,r.y2);a<=i&&(i=a,u=r)}}this.net.style.cursor=u?"pointer":"default";for(const i of w){const r=Math.min(1,Math.abs(i.weight)/A);this.netCtx.strokeStyle=i.weight>=0?`rgba(76, 175, 80, ${.15+r*.7})`:`rgba(244, 67, 54, ${.15+r*.7})`,this.netCtx.lineWidth=.5+r*2,this.netCtx.beginPath(),this.netCtx.moveTo(i.x1,i.y1),this.netCtx.lineTo(i.x2,i.y2),this.netCtx.stroke()}u&&(this.netCtx.strokeStyle="rgba(255, 255, 255, 0.95)",this.netCtx.lineWidth=3,this.netCtx.beginPath(),this.netCtx.moveTo(u.x1,u.y1),this.netCtx.lineTo(u.x2,u.y2),this.netCtx.stroke()),this.netCtx.fillStyle="rgba(255, 255, 255, 0.9)",this.netCtx.font="12px JetBrains Mono, monospace",this.netCtx.fillText("Input",b-28,14);for(let i=0;i<o;i++)this.netCtx.fillText(`H${i+1}`,y[i]-10,14);o===0&&this.netCtx.fillText("Direct",G/2-20,14),this.netCtx.fillText("Output",f-24,14);for(let i=0;i<M;i++){const r=s.input[i],a=Math.min(1,Math.abs(r));a>.02&&(this.netCtx.fillStyle=r>=0?`rgba(41, 182, 246, ${.1+a*.55})`:`rgba(255, 183, 77, ${.1+a*.55})`,this.netCtx.beginPath(),this.netCtx.arc(b,C[i],7+a*4,0,Math.PI*2),this.netCtx.fill()),this.netCtx.fillStyle=r>=0?"#29b6f6":"#ffb74d",this.netCtx.beginPath(),this.netCtx.arc(b,C[i],5,0,Math.PI*2),this.netCtx.fill(),this.netCtx.fillStyle="rgba(255, 255, 255, 0.88)",this.netCtx.font="10px JetBrains Mono, monospace",this.netCtx.fillText(J[i],6,C[i]+3)}for(let i=0;i<o;i++){const r=s.hidden[i],a=g[i];for(let m=0;m<a.length;m++){const S=r[m],I=Math.min(1,Math.abs(S));I>.02&&(this.netCtx.fillStyle=S>=0?`rgba(76, 175, 80, ${.1+I*.6})`:`rgba(244, 67, 54, ${.1+I*.6})`,this.netCtx.beginPath(),this.netCtx.arc(y[i],a[m],7+I*4,0,Math.PI*2),this.netCtx.fill()),this.netCtx.fillStyle=S>=0?"#26a69a":"#ef5350",this.netCtx.beginPath(),this.netCtx.arc(y[i],a[m],5,0,Math.PI*2),this.netCtx.fill()}}for(let i=0;i<F;i++){const r=s.output[i],a=Math.min(1,Math.abs(r)/n);a>.02&&(this.netCtx.fillStyle=r>=0?`rgba(76, 175, 80, ${.12+a*.6})`:`rgba(244, 67, 54, ${.12+a*.6})`,this.netCtx.beginPath(),this.netCtx.arc(f,c[i],8+a*5,0,Math.PI*2),this.netCtx.fill()),this.netCtx.fillStyle=i===s.best?"#ffd54f":"#ffb74d",this.netCtx.beginPath(),this.netCtx.arc(f,c[i],6,0,Math.PI*2),this.netCtx.fill(),i===s.best&&(this.netCtx.strokeStyle="rgba(255, 255, 255, 0.9)",this.netCtx.lineWidth=1.5,this.netCtx.beginPath(),this.netCtx.arc(f,c[i],9,0,Math.PI*2),this.netCtx.stroke()),this.netCtx.fillStyle="rgba(255, 255, 255, 0.9)",this.netCtx.font="11px JetBrains Mono, monospace",this.netCtx.fillText(j[i],f+12,c[i]+3),this.netCtx.fillStyle="rgba(255, 255, 255, 0.65)",this.netCtx.font="9px JetBrains Mono, monospace",this.netCtx.fillText(`b=${e[Z+i].toFixed(2)}`,f+12,c[i]+14),this.netCtx.fillText(`a=${r.toFixed(2)}`,f+12,c[i]+24)}if(u&&this.netMouse){const i=u.label,r=`w = ${u.weight.toFixed(4)}`;this.netCtx.font="10px JetBrains Mono, monospace";const m=Math.max(this.netCtx.measureText(i).width,this.netCtx.measureText(r).width)+12,S=34,I=Math.min(G-m-4,this.netMouse.x+10),O=Math.max(4,this.netMouse.y-S-8);this.netCtx.fillStyle="rgba(12, 12, 12, 0.95)",this.netCtx.fillRect(I,O,m,S),this.netCtx.strokeStyle="rgba(255, 255, 255, 0.25)",this.netCtx.lineWidth=1,this.netCtx.strokeRect(I,O,m,S),this.netCtx.fillStyle="rgba(255, 255, 255, 0.92)",this.netCtx.fillText(i,I+6,O+13),this.netCtx.fillStyle="rgba(255, 255, 255, 0.75)",this.netCtx.fillText(r,I+6,O+26)}}drawBoard(t){const e=t.boardAgent;this.ctx.fillStyle="#000",this.ctx.fillRect(0,0,E,E),this.ctx.strokeStyle="rgba(255, 255, 255, 0.12)",this.ctx.lineWidth=1.1;for(let s=0;s<=E;s+=B)this.ctx.beginPath(),this.ctx.moveTo(s+.5,0),this.ctx.lineTo(s+.5,E),this.ctx.stroke(),this.ctx.beginPath(),this.ctx.moveTo(0,s+.5),this.ctx.lineTo(E,s+.5),this.ctx.stroke();this.ctx.fillStyle="#f44336",this.ctx.fillRect(e.food.x*B+3,e.food.y*B+3,B-6,B-6);for(let s=e.body.length-1;s>=0;s--){const n=e.body[s];this.ctx.fillStyle=s===0?"#4caf50":"#43a047",this.ctx.fillRect(n.x*B+2,n.y*B+2,B-4,B-4)}}drawHistory(t){this.chartCtx.fillStyle="#000",this.chartCtx.fillRect(0,0,R,N),this.chartCtx.strokeStyle="rgba(255, 255, 255, 0.12)",this.chartCtx.lineWidth=1;for(let s=1;s<=3;s++){const n=N*s/4;this.chartCtx.beginPath(),this.chartCtx.moveTo(0,n+.5),this.chartCtx.lineTo(R,n+.5),this.chartCtx.stroke()}if(t.length<2)return;let e=1;for(const s of t)s>e&&(e=s);this.chartCtx.strokeStyle="#646cff",this.chartCtx.lineWidth=2,this.chartCtx.beginPath();for(let s=0;s<t.length;s++){const n=10+s/(t.length-1)*(R-20),o=N-10-t[s]/e*(N-20);s===0?this.chartCtx.moveTo(n,o):this.chartCtx.lineTo(n,o)}this.chartCtx.stroke(),this.chartCtx.fillStyle="rgba(255, 255, 255, 0.75)",this.chartCtx.font="12px IBM Plex Mono, monospace",this.chartCtx.fillText(`Gen best fitness history (max ${e.toFixed(2)})`,10,16)}updateStats(t){this.stats.innerHTML=[`Generation: <strong>${t.generation}</strong>`,`Alive: ${t.alive}/${t.populationSize}`,`Grid: ${l}x${l}`,`Best score: ${t.bestEverScore}`,`Best fitness: ${t.bestEverFitness.toFixed(2)}`,`Stale: ${t.staleGenerations}`].join("<br>")}}const Et=.4;class It{randomGenome(){const t=new Float32Array(z);for(let e=0;e<t.length;e++)t[e]=this.randomRange(-1,1);return t}evolve(t){for(const n of t)n.fitness=this.fitness(n);const e=[...t].sort((n,o)=>o.fitness-n.fitness),s=[];for(let n=0;n<mt;n++)s.push(e[n].genome);for(;s.length<Q;){const n=this.pickParent(e),o=this.pickParent(e),h=this.crossover(n.genome,o.genome);this.mutate(h),s.push(h)}return{best:e[0],nextGenomes:s}}randomRange(t,e){return t+Math.random()*(e-t)}randomIndex(t){return Math.floor(Math.random()*t)}fitness(t){const e=t.score,s=!t.alive&&t.hunger>0?1:0,n=t.steps/(l*l);return e-s-n}crossover(t,e){const s=new Float32Array(z);for(let n=0;n<z;n++)s[n]=Math.random()<.5?t[n]:e[n];return s}mutate(t){for(let e=0;e<t.length;e++)Math.random()<yt&&(t[e]+=this.randomRange(-et,et))}pickParent(t){const e=Math.max(2,Math.floor(t.length*Et));let s=t[this.randomIndex(e)];for(let n=1;n<pt;n++){const o=t[this.randomIndex(e)];o.fitness>s.fitness&&(s=o)}return s}}function lt(){return x.map(T=>new Float32Array(T))}class At{actionHiddenBuffers=lt();chooseAction(t,e){return this.run(t,e,this.actionHiddenBuffers)}run(t,e,s,n){{const f=x[0],C=s[0];for(let c=0;c<f;c++){let w=t[W+c];const A=Y+c*M;for(let u=0;u<M;u++)w+=t[A+u]*e[u];C[c]=Math.tanh(w)}let y=X,g=W+f;for(let c=1;c<L;c++){const w=s[c-1],A=s[c],u=x[c-1],i=x[c];for(let r=0;r<i;r++){let a=t[g+r];const m=y+r*u;for(let S=0;S<u;S++)a+=t[m+S]*w[S];A[r]=Math.tanh(a)}y+=u*i,g+=i}}let o=0,h=Number.NEGATIVE_INFINITY;const p=s[L-1],b=x[L-1];for(let f=0;f<F;f++){let C=t[Z+f];const y=$+f*b;for(let g=0;g<b;g++)C+=t[y+g]*p[g];n&&(n[f]=C),C>h&&(h=C,o=f)}return o}}function Bt(){return lt()}class Ft{constructor(t){this.network=t}actionInputs=new Float32Array(M);vizInputs=new Float32Array(M);vizHidden=Bt();vizOutputs=new Float32Array(F);createAgent(t){const e=Math.floor(l/2),s=Math.floor(l/2),n=[{x:e,y:s},{x:e-1,y:s},{x:e-2,y:s}];return{genome:new Float32Array(t),body:n,dir:1,food:this.randomFood(n),alive:!0,score:0,steps:0,hunger:tt,fitness:0}}step(t){if(!t.alive)return;switch(this.chooseAction(t)){case 1:t.dir=(t.dir+3)%4;break;case 2:t.dir=(t.dir+1)%4;break}const s=D[t.dir],n=t.body[0],o={x:n.x+s.x,y:n.y+s.y};if(t.steps+=1,t.hunger-=1,this.outOfBounds(o.x,o.y)){t.alive=!1;return}const h=o.x===t.food.x&&o.y===t.food.y,p=h?t.body.length:t.body.length-1;if(this.pointInBody(t.body,o,p)){t.alive=!1;return}if(t.body.unshift(o),h){if(t.score+=1,t.score>=ht){t.alive=!1;return}t.hunger=tt,t.food=this.randomFood(t.body)}else t.body.pop();t.hunger<=0&&(t.alive=!1)}computeNetworkActivations(t,e){e?this.senseInto(e,this.vizInputs):this.vizInputs.fill(0);const s=this.network.run(t,this.vizInputs,this.vizHidden,this.vizOutputs);return{input:this.vizInputs,hidden:this.vizHidden,output:this.vizOutputs,best:s}}randomIndex(t){return Math.floor(Math.random()*t)}randomFood(t){if(t.length>=l*l)return{...t[0]};for(;;){const e={x:this.randomIndex(l),y:this.randomIndex(l)};if(!this.pointInBody(t,e,t.length))return e}}pointInBody(t,e,s){for(let n=0;n<s;n++){const o=t[n];if(o.x===e.x&&o.y===e.y)return!0}return!1}outOfBounds(t,e){return t<0||t>=l||e<0||e>=l}checkForObstacle(t,e,s){const n=t.x+e.x,o=t.y+e.y;if(this.outOfBounds(n,o))return 1;for(let h=1;h<s.length;h++)if(s[h].x===n&&s[h].y===o)return 1;return 0}findTailDistance(t,e,s){for(let n=1;n<=l;n++){const o=t.x+e.x*n,h=t.y+e.y*n;if(this.outOfBounds(o,h))return 0;for(let p=1;p<s.length;p++)if(s[p].x===o&&s[p].y===h)return 1/n}return 0}checkForFood(t,e,s){const n=s.x-t.x,o=s.y-t.y,h=n*e.x+o*e.y;return Math.sign(h)}senseInto(t,e){const s=t.body[0],n=D[t.dir],o=D[(t.dir+3)%4],h=D[(t.dir+1)%4];e[0]=this.checkForObstacle(s,n,t.body),e[1]=this.checkForObstacle(s,o,t.body),e[2]=this.checkForObstacle(s,h,t.body),e[3]=this.findTailDistance(s,n,t.body),e[4]=this.findTailDistance(s,o,t.body),e[5]=this.findTailDistance(s,h,t.body),e[6]=this.checkForFood(s,n,t.food)>0?1:0,e[7]=this.checkForFood(s,o,t.food),e[8]=n.x,e[9]=n.y}chooseAction(t){return this.senseInto(t,this.actionInputs),this.network.chooseAction(t.genome,this.actionInputs)}}class Ot{ga=new It;network=new At;environment=new Ft(this.network);population=[];generation=1;bestEverScore=0;bestEverFitness=0;bestFitnessGen=1;fitnessHistory=[];showcaseGenome=null;showcaseAgent=null;constructor(){this.reset()}reset(){this.population=[],this.generation=1,this.bestEverScore=0,this.bestEverFitness=0,this.bestFitnessGen=1,this.fitnessHistory=[],this.showcaseGenome=null,this.showcaseAgent=null;for(let t=0;t<Q;t++)this.population.push(this.environment.createAgent(this.ga.randomGenome()));this.population.length>0&&this.setShowcaseGenome(this.population[0].genome)}simulate(t){for(let e=0;e<t;e++){let s=0;for(const n of this.population)n.alive&&(this.environment.step(n),n.alive&&(s+=1));s===0&&this.evolve(),this.showcaseAgent&&this.environment.step(this.showcaseAgent),!this.showcaseAgent?.alive&&this.showcaseGenome&&(this.showcaseAgent=this.environment.createAgent(this.showcaseGenome))}}getState(){let t=0;for(const n of this.population)n.alive&&(t+=1);const e=this.showcaseAgent??this.population[0],s=this.showcaseGenome?{genome:this.showcaseGenome,activations:this.environment.computeNetworkActivations(this.showcaseGenome,this.showcaseAgent)}:{genome:null,activations:null};return{boardAgent:e,fitnessHistory:this.fitnessHistory,generation:this.generation,alive:t,populationSize:Q,bestEverScore:this.bestEverScore,bestEverFitness:this.bestEverFitness,staleGenerations:Math.max(0,this.generation-this.bestFitnessGen),network:s}}onGridSizeChanged(){this.population=this.population.map(t=>this.environment.createAgent(t.genome)),this.showcaseGenome?this.showcaseAgent=this.environment.createAgent(this.showcaseGenome):this.showcaseAgent=null}setShowcaseGenome(t){this.showcaseGenome=new Float32Array(t),this.showcaseAgent=this.environment.createAgent(this.showcaseGenome)}evolve(){const{best:t,nextGenomes:e}=this.ga.evolve(this.population);this.bestEverScore=Math.max(this.bestEverScore,t.score),(this.generation===1||t.fitness>this.bestEverFitness)&&(this.bestEverFitness=t.fitness,this.bestFitnessGen=this.generation,this.setShowcaseGenome(t.genome)),this.fitnessHistory.push(t.fitness),this.fitnessHistory.length>500&&this.fitnessHistory.shift(),this.population=e.map(s=>this.environment.createAgent(s)),this.generation+=1}}class Ht{trainer=new Ot;renderer;turboToggle;gridDownButton;gridUpButton;resetButton;gridValue;turboMode=!1;stepBudget=0;lastFrameTime=0;constructor(){const t=this.getCanvas("netCanvas"),e=this.getCanvas("gameCanvas"),s=this.getCanvas("chartCanvas"),n=this.getElement("stats");this.turboToggle=this.getInput("turboToggle");const o=this.getInput("networkToggle");this.gridDownButton=this.getButton("gridDown"),this.gridUpButton=this.getButton("gridUp"),this.resetButton=this.getButton("resetTraining"),this.gridValue=this.getElement("gridValue"),this.renderer=new Mt({netCanvas:t,boardCanvas:e,chartCanvas:s,statsElement:n}),this.turboMode=this.turboToggle.checked,this.turboToggle.addEventListener("change",()=>{this.turboMode=this.turboToggle.checked,this.stepBudget=0}),this.renderer.setShowNetwork(o.checked),o.addEventListener("change",()=>{this.renderer.setShowNetwork(o.checked)}),this.gridDownButton.addEventListener("click",()=>{this.updateGridSize(-U)}),this.gridUpButton.addEventListener("click",()=>{this.updateGridSize(U)}),this.resetButton.addEventListener("click",()=>{this.resetTraining()}),this.refreshGridControls(),requestAnimationFrame(this.loop)}getCanvas(t){const e=document.getElementById(t);if(!(e instanceof HTMLCanvasElement))throw new Error(`Missing canvas: ${t}`);return e}getElement(t){const e=document.getElementById(t);if(!e)throw new Error(`Missing element: ${t}`);return e}getInput(t){const e=document.getElementById(t);if(!(e instanceof HTMLInputElement))throw new Error(`Missing input: ${t}`);return e}getButton(t){const e=document.getElementById(t);if(!(e instanceof HTMLButtonElement))throw new Error(`Missing button: ${t}`);return e}updateGridSize(t){const e=l,s=Tt(e+t);this.refreshGridControls(),s!==e&&(this.trainer.onGridSizeChanged(),this.stepBudget=0,this.lastFrameTime=0)}refreshGridControls(){this.gridValue.textContent=`${l}x${l}`,this.gridDownButton.disabled=l<=P,this.gridUpButton.disabled=l>=K}resetTraining(){this.trainer.reset(),this.stepBudget=0,this.lastFrameTime=0}loop=t=>{this.lastFrameTime===0&&(this.lastFrameTime=t);const e=Math.max(0,(t-this.lastFrameTime)/1e3);if(this.lastFrameTime=t,this.turboMode){const s=performance.now();do this.trainer.simulate(1);while(performance.now()-s<Ct)}else{this.stepBudget+=e*bt;const s=Math.floor(this.stepBudget);s>0&&(this.stepBudget-=s,this.trainer.simulate(s))}this.renderer.render(this.trainer.getState()),requestAnimationFrame(this.loop)}}new Ht;
